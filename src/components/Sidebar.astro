---
const now = new Date();
const year = now.getFullYear();
---
<aside class="sidebar" aria-label="Navigation">
  <a class="brand" href="/" aria-label="Revenir √† l'accueil">
    <div class="logo" aria-hidden="true"></div>
    <div class="brand-text">
      <div class="title">L'arbraphore</div>
      <small class="muted">Mon √©lan po√©tique</small>
    </div>
  </a>

  <div class="search">
    <form action="/search" method="get">
      <input type="search" name="q" placeholder="Rechercher‚Ä¶" aria-label="Rechercher" />
    </form>
    <div class="stacked-actions">
      <div class="split-pill" role="group" aria-label="Acc√®s aux articles">
        <a class="pill" href="/articles">Articles</a>
        <a class="pill icon" href="/rss.xml" aria-label="Flux RSS des articles">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 17a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm5.5 1.3A9.7 9.7 0 0 0 2 10v3a6.7 6.7 0 0 1 6.7 6.7h1.8Zm4.2 0A13.8 13.8 0 0 0 2 6v3.2c5.1 0 9.3 4.1 9.3 9.3h3.4Z" fill="currentColor" />
          </svg>
        </a>
      </div>
      <div class="split-pill" role="group" aria-label="Acc√®s au journal">
        <a class="pill" href="/journal">Journal</a>
        <a class="pill icon" href="/rss/journal.xml" aria-label="Flux RSS du journal">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="M5 17a2 2 0 1 1-4 0 2 2 0 0 1 4 0Zm5.5 1.3A9.7 9.7 0 0 0 2 10v3a6.7 6.7 0 0 1 6.7 6.7h1.8Zm4.2 0A13.8 13.8 0 0 0 2 6v3.2c5.1 0 9.3 4.1 9.3 9.3h3.4Z" fill="currentColor" />
          </svg>
        </a>
      </div>
    </div>
  </div>

  <nav>
    <a class="pill" href="/about">√Ä propos (s√©quences)</a>
  </nav>

  <div class="hr"></div>

  <div class="row footer-row">
    <small class="muted">¬© {year}</small>
    <a class="pill tiny edit-link" href="/admin/">√âditer</a>
    <button type="button" id="themeBtn" aria-label="Basculer le th√®me">‚òÄÔ∏è</button>
  </div>

  <script type="module">
    const btn = document.getElementById('themeBtn');
    const getTheme = () => document.documentElement.dataset.theme || 'light';

    const stored = localStorage.getItem('theme');
    if (stored === 'dark' || stored === 'light') {
      document.documentElement.dataset.theme = stored;
    }

    function updateIcon(theme){
      const isDark = theme === 'dark';
      btn.textContent = isDark ? 'üåô' : '‚òÄÔ∏è';
      btn.setAttribute('aria-label', isDark ? 'Passer en mode clair' : 'Passer en mode sombre');
    }

    updateIcon(getTheme());

    btn?.addEventListener('click', () => {
      const cur = getTheme();
      const next = cur === 'dark' ? 'light' : 'dark';
      window.__setTheme?.(next);
      updateIcon(next);
    });
  </script>
</aside>
